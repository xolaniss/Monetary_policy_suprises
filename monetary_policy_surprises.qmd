---
format:
  pdf:
    tbl-cap-location: top
    dpi: 500
    fig-pos: "H"
    number-sections: true
    cite-method: natbib
    include-in-header: preamble.tex
    include-before-body: title.tex
    keep-tex: true
pdf-engine: lualatex
monofont: "DejaVu Sans Mono"
mainfont: "Times New Roman"
execute: 
  echo: false
  warning: false
editor: source
bibliography: references.bib
biblio-style: apalike
natbiboptions: round
link-citations: true
linkcolor: blue!100!black
urlcolor: blue!100!black
citecolor: blue!100!black
linestretch: 1.5
indent: TRUE
---

```{r}
#| label: setup
#| warning: FALSE
#| message: FALSE

options(scipen=999)
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE, 
                      message = FALSE, 
                      dpi = 500, 
                      fig.pos = "H", 
                      fig.env= 'figure', 
                      tab.topcaption = TRUE,
                      ft.align = "left",
                      ft.tabcolsep= 0, 
                      ft.latex.float = "none"
                      )
library(tidyverse)
library(readr)
library(readxl)
library(zoo)
library(magick)
library(stringi)
library(patchwork)
library(xtable)
library(scales)
library(rvest)
library(rebus)
library(PNWColors)
library(lubridate)
library(here)
library(flextable)
library(gt)
library(officer)
library(officedown)
library(modelsummary)
library(sandwich)
library(lmtest)
library(stargazer)
```

```{r}
#| label: func
source(here("Functions","flextable_pdf.R" ))
source(here("Functions","modelsummary_pdf.R" ))
source(here("Functions","borderlines.R" ))

set_flextable_defaults(font.size = 8, 
                       text.align = "left", 
                       font.color = "black", 
                       theme_fun = theme_apa, 
                       padding = 0,
                       line_spacing = 0)
```


# Introduction

# Literature Review
@gurkaynak2005a \
@ho2021 \
@gurkaynak2005

# Methodology


# Data


# Empirical Results


# Conclusion

\newpage
# References {.unnumbered}
::: {#refs}
:::

\setcounter{section}{0}
\renewcommand{\thesection}{\Alph{section}}

\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}

\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}

\newpage

# Appendix

## Repo Rate Path

```{r}
#| label: fig-repo_rate
#| fig-cap: "Repo Rate Path"
#| fig-height: 2
#| fig-width: 8
#| cache: FALSE

repo <- read_rds(here("Outputs", "artifacts_announcement_days.rds"))
repo$plots$daily_repo_gg

```

## Daily Repo Rate Changes

```{r}
#| label: fig-repo_rate_changes
#| fig-cap: "Repo Rate Changes"
#| fig-height: 2
#| fig-width: 8
#| cache: FALSE

repo$plots$repo_changes_gg
```

\newpage

## Announcement Days

```{r}
#| label: tbl-announcement_days
#| tbl-cap: "Announcement Days"
#| cache: FALSE
#| ft.arraystretch: .4

announcement_days_tbl <- 
  repo$data$announcement_days_tbl

announcement_days_tbl %>%
  flextable_pdf(
    width_add = 2.5
  ) %>% 
  colformat_num(
    columns = 2:3,
    digits = 2
  ) %>% 
  align(align = "left", part = "all")
  
```


## Exchange rates

```{r}
#| label: fig-exchange_rates
#| fig-cap: "Exchange Rates"
#| fig-height: 4
#| fig-width: 8
#| cache: FALSE

exchange_rates <- read_rds(here("Outputs", "artifacts_exchange_rates.rds"))
exchange_rates$exchange_rate_gg

```


## Commodities

```{r}
#| label: fig-commodities
#| fig-cap: "Commodities"
#| fig-height: 6
#| fig-width: 8
#| cache: FALSE

commodities <- read_rds(here("Outputs", "artifacts_commodities.rds"))
commodities$commodities_gg

```


## Stock Market

```{r}
#| label: fig-stock_market
#| fig-cap: "Stock Market"
#| fig-height: 2
#| fig-width: 8
#| cache: FALSE

stock_market <- read_rds(here("Outputs", "artifacts_assets.rds"))
stock_market$assets_gg

```



## Bonds

```{r}
#| label: fig-bonds
#| fig-cap: "Bonds"
#| fig-height: 6
#| fig-width: 8
#| cache: FALSE

bonds <- read_rds(here("Outputs", "artifacts_bonds.rds"))
bonds$bonds_gg

```

\newpage

## Forward Rates

```{r}
#| label: fig-forward_rates
#| fig-cap: "Forward Rates"
#| fig-height: 4
#| fig-width: 8
#| cache: FALSE

forward_rates <- read_rds(here("Outputs", "artifacts_forwards.rds"))
forward_rates$forwards_gg

```


